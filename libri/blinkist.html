<script>
    // Content data in English and Italian
    const content = {
        en: {
            sections: [
                {
                    title: 'The Nature of Money',
                    buttonLabel: 'ðŸ’° Money',
                    content: [
                        {
                            type: 'questions',
                            content: [
                                'What are the limitations of barter?',
                                'What characteristics define good money?',
                                'How do different monetary systems impact societal development?'
                            ]
                        },
                        {
                            type: 'data',
                            content: [
                                'Copper demand: 20 million tons/year at $5,000/ton, totaling ~$100 billion market value.',
                                'Central banks hold about 20% of global gold stockpiles.'
                            ]
                        },
                        {
                            type: 'quotes',
                            content: [
                                'Barter is impractical and used only in exceptional circumstances among familiar parties.',
                                'Successful money restricts new supply to maintain value over time.',
                                'Money has evolved from seashells to digital forms, each with benefits and challenges.'
                            ]
                        }
                    ]
                },
                // ... (Other sections)
                {
                    title: 'Bitcoin as Monetary System',
                    buttonLabel: 'â‚¿ Bitcoin',
                    content: [
                        // ... (Content)
                    ]
                }
            ],
            bookDetails: {
                image: 'https://via.placeholder.com/150', // Placeholder image
                title: 'The Bitcoin Standard',
                author: 'Saifedean Ammous',
                year: '2018',
                pages: '304',
                link: 'https://example.com/buy',
                offerCoffeeLink: 'https://example.com/coffee'
            }
        },
        it: {
            sections: [
                {
                    title: 'La Natura del Denaro',
                    buttonLabel: 'ðŸ’° Denaro',
                    content: [
                        {
                            type: 'questions',
                            content: [
                                'Quali sono i limiti del baratto?',
                                'Quali caratteristiche definiscono un buon denaro?',
                                'Come diversi sistemi monetari influenzano lo sviluppo sociale?'
                            ]
                        },
                        {
                            type: 'data',
                            content: [
                                'Domanda di rame: 20 milioni di tonnellate/anno a $5.000/tonnellata, per un valore di mercato di ~$100 miliardi.',
                                'Le banche centrali detengono circa il 20% delle riserve globali di oro.'
                            ]
                        },
                        {
                            type: 'quotes',
                            content: [
                                'Il baratto Ã¨ impratico e usato solo in circostanze eccezionali tra persone familiari.',
                                'Un denaro di successo limita la nuova offerta per mantenere il valore nel tempo.',
                                'Il denaro si Ã¨ evoluto da conchiglie a forme digitali, ognuna con benefici e sfide.'
                            ]
                        }
                    ]
                },
                // ... (Other sections)
                {
                    title: 'Bitcoin come Sistema Monetario',
                    buttonLabel: 'â‚¿ Bitcoin',
                    content: [
                        // ... (Content)
                    ]
                }
            ],
            bookDetails: {
                image: 'https://via.placeholder.com/150', // Placeholder image
                title: 'Lo Standard Bitcoin',
                author: 'Saifedean Ammous',
                year: '2018',
                pages: '304',
                link: 'https://example.com/buy',
                offerCoffeeLink: 'https://example.com/coffee'
            }
        }
    };

    let currentLanguage = 'en';

    // Get DOM elements
    const buttonsContainer = document.getElementById('buttons-container');
    const cardsWrapper = document.getElementById('cards-wrapper');
    const progressBar = document.querySelector('.progress-bar');
    const languageSwitch = document.getElementById('language-switch');

    let cards = [];
    let currentIndex = 0;

    function initializeApp() {
        buttonsContainer.innerHTML = '';
        cardsWrapper.innerHTML = '';
        cards = [];
        currentIndex = 0;

        const { sections, bookDetails } = content[currentLanguage];

        // Create buttons and cards for sections
        sections.forEach((section, index) => {
            createButton(section.buttonLabel, index);
            createCard(section);
        });

        // Create "Book Details" button and card
        createButton('ðŸ“– Details', sections.length);
        createBookCard(bookDetails);

        // Initialize to show the first card
        showCard(0);
    }

    // Function to create a button
    function createButton(label, index) {
        const button = document.createElement('div');
        button.className = 'button';
        button.textContent = label;
        button.addEventListener('click', () => {
            showCard(index);
        });
        buttonsContainer.appendChild(button);
    }

    // Function to create a content block
    function createContentBlock(type, contents) {
        const div = document.createElement('div');
        div.className = `content-block ${type}`;

        contents.forEach(item => {
            const p = document.createElement('p');
            p.textContent = item;
            div.appendChild(p);
        });

        return div;
    }

    // Function to create a card
    function createCard(section) {
        const card = document.createElement('div');
        card.className = 'card';

        const cardContent = document.createElement('div');
        cardContent.className = 'card-content';

        const title = document.createElement('h2');
        title.className = 'section-title';
        title.textContent = section.title;
        cardContent.appendChild(title);

        section.content.forEach(block => {
            const contentBlock = createContentBlock(block.type, block.content);
            cardContent.appendChild(contentBlock);
        });

        card.appendChild(cardContent);

        cardsWrapper.appendChild(card);
        cards.push(card);
    }

    // Function to create the book details card
    function createBookCard(bookDetails) {
        const card = document.createElement('div');
        card.className = 'card';

        const cardContent = document.createElement('div');
        cardContent.className = 'card-content';

        cardContent.innerHTML = `
            <img src="${bookDetails.image}" alt="Book Cover" style="width:100%; height:auto; border-radius: 10px;">
            <h2>${bookDetails.title}</h2>
            <p><strong>${currentLanguage === 'en' ? 'Author' : 'Autore'}:</strong> ${bookDetails.author}</p>
            <p><strong>${currentLanguage === 'en' ? 'Year' : 'Anno'}:</strong> ${bookDetails.year}</p>
            <p><strong>${currentLanguage === 'en' ? 'Pages' : 'Pagine'}:</strong> ${bookDetails.pages}</p>
            <p><a href="${bookDetails.link}" target="_blank">${currentLanguage === 'en' ? 'Buy this book' : 'Acquista il libro'}</a></p>
            <button class="coffee-button" onclick="window.open('${bookDetails.offerCoffeeLink}', '_blank')">${currentLanguage === 'en' ? 'â˜• Offer me a coffee' : 'â˜• Offrimi un caffÃ¨'}</button>
        `;

        card.appendChild(cardContent);

        cardsWrapper.appendChild(card);
        cards.push(card);
    }

    // Function to display a specific card
    function showCard(index) {
        currentIndex = index;
        cardsWrapper.style.transform = `translateX(-${index * 100}%)`;
        const progress = ((index + 1) / cards.length) * 100;
        progressBar.style.width = `${progress}%`;
    }

    // Swipe functionality
    let startX = 0;
    let isDown = false;

    const cardsContainer = document.querySelector('.cards-container');

    // Touch events for mobile
    cardsContainer.addEventListener('touchstart', touchStart, false);
    cardsContainer.addEventListener('touchmove', touchMove, false);
    cardsContainer.addEventListener('touchend', touchEnd, false);

    function touchStart(evt) {
        startX = evt.touches[0].clientX;
        isDown = true;
        cardsWrapper.style.transition = 'none';
    }

    function touchMove(evt) {
        if (!isDown) return;
        const x = evt.touches[0].clientX;
        const deltaX = x - startX;
        cardsWrapper.style.transform = `translateX(${ -currentIndex * 100 + (deltaX / window.innerWidth) * 100 }%)`;
    }

    function touchEnd(evt) {
        if (!isDown) return;
        isDown = false;
        const endX = evt.changedTouches[0].clientX;
        const deltaX = endX - startX;
        if (deltaX < -50 && currentIndex < cards.length - 1) {
            currentIndex++;
        } else if (deltaX > 50 && currentIndex > 0) {
            currentIndex--;
        }
        cardsWrapper.style.transition = 'transform 0.5s ease-in-out';
        showCard(currentIndex);
    }

    // Mouse events for desktop
    cardsContainer.addEventListener('mousedown', mouseDown, false);
    cardsContainer.addEventListener('mousemove', mouseMove, false);
    cardsContainer.addEventListener('mouseup', mouseUp, false);
    cardsContainer.addEventListener('mouseleave', mouseUp, false);

    function mouseDown(evt) {
        startX = evt.clientX;
        isDown = true;
        cardsWrapper.style.transition = 'none';
    }

    function mouseMove(evt) {
        if (!isDown) return;
        const x = evt.clientX;
        const deltaX = x - startX;
        cardsWrapper.style.transform = `translateX(${ -currentIndex * 100 + (deltaX / window.innerWidth) * 100 }%)`;
    }

    function mouseUp(evt) {
        if (!isDown) return;
        isDown = false;
        const endX = evt.clientX;
        const deltaX = endX - startX;
        if (deltaX < -50 && currentIndex < cards.length - 1) {
            currentIndex++;
        } else if (deltaX > 50 && currentIndex > 0) {
            currentIndex--;
        }
        cardsWrapper.style.transition = 'transform 0.5s ease-in-out';
        showCard(currentIndex);
    }

    // Language switch functionality
    languageSwitch.addEventListener('click', () => {
        currentLanguage = currentLanguage === 'en' ? 'it' : 'en';
        languageSwitch.textContent = currentLanguage === 'en' ? 'ðŸ‡®ðŸ‡¹' : 'ðŸ‡¬ðŸ‡§';
        initializeApp();
    });

    // Initialize the app
    initializeApp();
</script>
